<!DOCTYPE html>
<html>
<head>
        <title>encukou/blog &mdash; Týdenní poznámky #2</title>
        <meta charset="utf-8" />
        <link rel="profile" href="http://gmpg.org/xfn/11" />
        <link rel="stylesheet" type="text/css" href="https://encukou.cz/theme/css/style.css" />
        <link href='https://fonts.googleapis.com/css?family=Signika|Jockey+One&amp;subset=latin,latin-ext' rel='stylesheet' type='text/css'>
        <style type="text/css">
            body.custom-background { background-color: #f5f5f5; }
        </style>
        <link rel="alternate" type="application/atom+xml"
            title="encukou/blog — Atom"
            href="https://encukou.cz/feeds/all.atom.xml" />
        <link rel="icon" type="image/png" href="https://encukou.cz/images/eck512.png">
        <!--[if lte IE 8]><script src="https://encukou.cz/theme/js/html5shiv.js"></script><![endif]-->
</head>

<body class="home blog custom-background single-author" >
    <div id="container">
        <div id="header">
                <h1 id="site-title"><a href="https://encukou.cz"><span class="_en">en</span><span class="_cu">cu</span><span class="_kou">kou</span>.cz</a></h1>
                <h2 id="site-description">primary colors underneath</h2>
        </div><!-- /#banner -->
        
        <div class="page-title">
        </div>

        <div id="menu">
            <div class="menu-navigation-container">
                <ul id="menu-navigation" class="menu">
                        <li class="menu-item menu-item-type-post_type menu-item-object-page _kou"><a href="mailto:encukou@gmail.com">e-mail</a></li>
                        <li class="menu-item menu-item-type-post_type menu-item-object-page _cu"><a href="https://mastodon.social/@encukou">mastodon</a></li>
                        <li class="menu-item menu-item-type-post_type menu-item-object-page _en"><a href="https://github.com/encukou">github</a></li>
                        <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://encukou.cz">home</a></li>

                </ul>
            </div> <!--/#menu-navigation-container-->
        </div><!-- /#menu -->

        <div id="contents">

<div class="post type-post status-publish format-standard hentry category-general">
    <div class="entry-meta">
        <div class="date"><a href="https://encukou.cz/blog/2021/01/15/cs-tydenni-02">2021-01-15</a></div>
    </div> <!-- /#entry-meta -->
    <div class="main">
        <h2 class="entry-title">
            <a href="https://encukou.cz/blog/2021/01/15/cs-tydenni-02" title="Permalink to Týdenní poznámky #2" rel="bookmark">Týdenní poznámky #2</a>
        </h2>
        <div class="entry-content">


<p>Utekl další týden (12. 1. – 15. 1.), a&nbsp;tak si sepisuju, co jsem&nbsp;dělal.</p>


<h2 id="pondeli-naucse">Pondělí: naucse</h2>
<p><a href="https://github.com/pyvec/naucse/pull/44">Opravil jsem CSS</a> pro lekce psané
v Jupyter Notebooku. Ještě to není úplně nasazené, příští týden&nbsp;dokončím.</p>
<p>Sepsal jsem si, co bude potřeba pro rozjezd videokurzu.
Zas tolik toho není; zatím to vypadá že největší překážka je asi drobnost
v <a href="https://projekty.pyladies.cz/">odevzdávátku</a>.
Tak se to snad povede a&nbsp;zorganizuju kurz – po pár letech co učím kurzy které
organizují <a href="https://pyladies.cz/brno/#past-meetups">PyLadies</a>.</p>
<h2 id="utery-cpython">Úterý: CPython</h2>
<p>Většinu úterka jsem strávil definování stabilního ABI – slučováním seznamů
z několika různých zdrojů.
Už se „těším“ na diskuse které nastanou až budu hotový se svým&nbsp;návrhem.</p>
<p>A&nbsp;pár menších věcí:</p>
<ul>
<li>Oprava <a href="https://github.com/python/cpython/pull/22632">správy paměti při importech</a>
  je konečně hotová</li>
<li>Oprava správy paměti <a href="https://bugs.python.org/issue40052">u <em>vectorcall</em></a>
  taky, bude v&nbsp;další revizi&nbsp;3.8.</li>
<li>Oprava <a href="https://github.com/python/cpython/pull/24119">zavírání souborů</a>
  v ttestech se trochu posunula,&nbsp;CI.</li>
</ul>
<p>Taky se strhla <a href="https://mail.python.org/archives/list/python-dev@python.org/thread/C4ILXGPKBJQYUN5YDMTJOEOX7RHOD4S3/#CKABGMLSJLKDGKUOMXA6MKO36MEWZIIS">mailová diskuse</a>
ohledně <em>heap types</em>.
Co to je? Zjednodušeně řečeno: typy které se dají měnit, na rozdíl od
<em>statických typů</em> jako např. <code>str</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">str</span><span class="o">.</span><span class="n">lower</span> <span class="o">=</span> <span class="s1">&#39;něco jiného&#39;</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">TypeError</span><span class="p">:</span> <span class="n">can</span><span class="s1">&#39;&#39;</span><span class="n">t</span> <span class="nb">set</span> <span class="n">attributes</span> <span class="n">of</span> <span class="n">built</span><span class="o">-</span><span class="ow">in</span><span class="o">/</span><span class="n">extension</span> <span class="nb">type</span> <span class="s1">&#39;str&#39;</span>
</code></pre></div>

<p>Třídy definované v Pythonu jsou <em>heap types</em>.
Aktuálně se na ně převádí spousta „vestavěných“ typů.
V aktuální alfa verzi Pythonu 3.10&nbsp;tak jde udělat třeba:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">array</span> <span class="kn">import</span> <span class="n">array</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">array</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="s1">&#39;něco jiného&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">array</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">count</span>
<span class="s1">&#39;něco jiného&#39;</span>
</code></pre></div>

<p>Diskuse se točila kolem toho, proč jsou <em>heap types</em> lepší, pokud chceme
umožnit <a href="https://www.python.org/dev/peps/pep-0554/">pod-interprety</a>
bez GIL (sdíleného zámku).</p>
<p>Než se bude dát měnit <code>str</code>, nějakou dobu to potrvá a&nbsp;nejspíš bude potřeba
změnit C-API Pythonu. Ale zatím to vypadá že nakonec to tak&nbsp;bude.</p>
<h2 id="streda-fedora">Středa: Fedora</h2>
<p>Ve středu jsem hlavně spravoval věci ve Fedoře.
Poslal jsem <a href="https://github.com/sqlalchemy/mako/pull/328">PR do šablonovacího jazyka Mako</a>,
který v Pythonu 3.10&nbsp;narážel na varování, což pak rozbíjelo testy projektů,
které Mako používají a&nbsp;varování ve svých vlastních testech berou jako&nbsp;chyby.</p>
<p>Taky jsem pokročil v balíčkování nové verze Pipenv, ale nestihl jsem to otestovat.
Miro se na to kouknul a&nbsp;hned asi tři našel.
(Pipenv je, mimochodem, strašlivé mocnáctihlavé monstrum. Ale užitečné.)</p>
<h2 id="ctvrtek-planovani-apython-2">Čtvrtek: Plánování a&nbsp;Python 2</h2>
<p>Ve čtvrtek jsem (kromě extra velké týmové porady) vyndával z Fedoray věci,
které ještě pořád potřebují Python 2.
Zbývá jich už <a href="https://fedora.portingdb.xyz/">jen 70</a>.</p>
<h2 id="patek-prace-vkorporatu">Pátek: Práce v&nbsp;korporátu</h2>
<p>No a&nbsp;v pátek jsem podobné nechtěné balíčky vyndával z budoucí verze <a href="https://en.wikipedia.org/wiki/Red_Hat_Enterprise_Linux">RHEL</a>u,
aby tam zbyly jen věci, které reálně můžeme nějaké to desetiletí&nbsp;podporovat.</p>        </div> <!--/#entry-content-->
            <span class="tag-links"><strong>⚑</strong>
 <a href="https://encukou.cz/blog/tag/weekly" rel="tag">weekly</a>            </span>
        <ul class="article-links">
                <li><a href="mailto:encukou@gmail.com?subject=Re:+článek+'T%C3%BDdenn%C3%AD%20pozn%C3%A1mky%20%232'">Přidat <em>komentář</em></a></li>
                <li><a href="https://github.com/encukou/blog/blob/master/posts/2021-01-15-cs-tydenni-02.md"><em>Forknout</em> tenhle článek na Githubu</a></li>
        </ul>
    </div> <!--/#main-->
</div>  <!--/#post-->
        </div>


<ul class="prev-next">
    <li class="prev">
        <a href="https://encukou.cz/blog/2021/01/08/cs-tydenni-01">
            Týdenní poznámky #1
        </a>
    </li>
    <li class="next">
        <a href="https://encukou.cz/blog/2021/01/22/cs-tydenni-03">
            Týdenní poznámky #3
        </a>
    </li>
</ul>
<span class="clearfix"></span>


        <footer id="footer">
            <p>
        
    tento blog používá systém <a href="https://getpelican.com/">Pelican</a>
    <br>
    styl adaptovaný z <a href="https://github.com/tbunnyman/pelican-chunk">pelican-chunk</a>
        © <a href="https://twitter.com/thisistran">Tran</a>
        a <a href="https://bunnyman.info/">tBunnyMan</a>
    <br>
    použité fonty: Signika © <a href="http://ancymonic.com/">Anna Giedryś</a>
        a Jockey One © <a href="www.type-together.com">TypeTogether</a>
    <br>
    tento blog je na <a href="https://github.com/encukou/blog">Githubu</a>
    <br>
    <br>
    text na této stránce je k dispozici pod licencí
    <a rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US">
            Creative Commons Attribution-ShareAlike 3.0 Unported</a>
    <br>
    © Petr Viktorin, <a href="https://encukou.cz">encukou.cz</a>
    
            </p>
        </footer>
    </div><!-- /#container -->
    <div style="display:none"></div>
</body>
</html>